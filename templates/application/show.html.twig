{% extends 'application/index.html.twig' %}

{% block title %}Заявка{% endblock %}

{% block admin_content %}
    <h3>Просмотр заявки № {{ application.id }}</h3>

    <div class="show-table">
        <table class="table table-hover">
            <tbody>
            <tr>
                <th>Клиент</th>
                <td><a href="{{ path('client_show', {'id': application.getClient().id }) }}">{{ application.getClient().lastname }} {{ application.getClient().firstname }} {{ application.getClient().middlename }}</a></td>
            </tr>
            <tr>
                <th>Услуга</th>
                <td>{{ application.title}}</td>
            </tr>
            <tr>
                <th>Текст обращения</th>
                <td>{{ application.content }}</td>
            </tr>
            <tr>
                <th>Статус</th>
                <td>{{ application.status }}</td>
            </tr>
            <tr>
                <th>Дата создания</th>
                <td>{{ application.getDateCreate()|date("d.m.Y в H:i")}}</td>
            </tr>
            {% if (is_granted("ROLE_ADMIN")) and ( application.getDateProcess()) %}
                <tr>
                    <th>Дата обработки</th>
                    <td>{{ application.getDateProcess()|date("d.m.Y в H:i")}}</td>
                </tr>
                <tr>
                    <th>Исполнитель</th>
                    <td><a href="{{ path('user_show', {'id': application.getUser().id }) }}">{{ application.getUser().lastname }} {{ application.getUser().firstname }} {{ application.getUser().middlename }}</a></td>
                </tr>
            {% endif %}
            </tbody>
        </table>
    </div>
    <div class="show-buttons">
        <a href="{{ path('applications_index') }}" class="btn btn-outline-primary">Назад к списку</a>
        <a href="{{ path('application_edit', {'id': application.id}) }}" class="btn btn-outline-primary">Редактировать</a>
        {% if (is_granted("ROLE_ADMIN")) %}
            <form class="delete-form" method="post" action="{{ path('application_delete', {'id': application.id}) }}" onsubmit="return confirm('Вы действительно хотите удалить эту заявку?');">
                <input type="hidden" name="_method" value="DELETE">
                <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ application.id) }}">
                <button class="btn btn-outline-primary right">Удалить</button>
            </form>
        {% endif %}
    </div>
{% endblock %}